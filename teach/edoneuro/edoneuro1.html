<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>EDOneuro Séance 1</title>

    <!--MATHJAX typing maths like in latex-->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script>
    <script type="text/javascript"
      src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
    <!-- MATHJAX-->

    <!-- jQuery -->
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script> 

    <!-- Bootstrap -->
    <link href="../../css/bootstrap.min.css" rel="stylesheet" media="all">

    <!-- Matlab highlighter -->
    <link href="../../css/matlab-highlighter-1.55.css" rel="stylesheet" type="text/css">
    <script src="../../js/matlab-highlighter-1.55.min.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>



   <!--<body style="padding-top: 50px;">-->
  <body onload="highlightMATLABCode();">

    <div class="container-fluid">
      <div class="row">


        <!--CONTENT HERE-->

        <ol class="breadcrumb">
            <li><a href="../../index.html">EDOneuro</a></li>
            <li class="active">TP de la séance 1</li>
        </ol>

        <div class="col-xs-12 col-sm-12 col-md-12">
          <h2>Modèle de FitzHugh-Nagumo</h2>
          <p>Le modèle de FitzHugh-Nagumo (FHN) est une simplification du modèle de Hodgkin-Huxley pour le potentiel d'action des axones géantes du calmar.</p>

          $$\dot v = v - v^3/3 - w + I(t)$$
          $$\dot w = 0.08 (v + 0.7 - 0.8w)$$

          <p>La variable <i>v</i> est le potentiel de la membrane, <i>w</i> un variable de récupération, et <i>I(t)</i> l'intensité de courant appliqué.</p>

          <p>Le fichier fonction <tt>.m</tt> <tt>Matlab</tt> peut être téléchargé ici <a href="fitzhughnagumo.m">fitzhughnagumo.m</a>. Le papier original de <a href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC1366333/pdf/biophysj00662-0010.pdf">Richard FitzHugh</a> peut être téléchargé librement. Le contenu du fichier <tt>Matlab</tt> se trouve aussi ci-dessous. Vous pouvez le copier et le coller dans votre éditeur de texte nommer le fichier <tt>fitzhughnagumo.m</tt>.</p>

          <pre class="matlab-code">
function simulation_output = fitzhughnagumo()
% FITZHUGHNAGUMO simule le modele de potentiel d'action de Fitzhugh-Nagumo

% Parametres du modele
a = 0.08;
b = 0.7;
c = 0.8;

% Parametres de courant applique
t0 = 10;
duree = 100; % 
intensite = 0.4; 

% Parametres de simulation
tspan = [0, 200]; % intervalle d'integration
ic = [-1.1993;
      -0.6243]; % conditions initiales

sol = ode45(@fitz,tspan,ic);

% plot des solutions
nx = 400;
xint = linspace(tspan(1),tspan(2),nx);
figure(1); clf;
yint = deval(sol,xint);

% plot des nullclines
vv = linspace(-2.5,2.5);
v_null_nostim = vv - vv.^3/3;
v_null_stim = vv - vv.^3/3 + intensite;
w_null = (vv + b)/c;

% evolution temporelle
subplot(121)
plot(xint,yint)
hold on             % qui ne s'effacera pas a chaque appel de plot
axis([tspan(1) tspan(2) -2.5 2.5]); 
axis square
xlabel('t'); ylabel('x');
legend('V - potentiel de la membrane', ...
    'W - variable de recuperation')

% portrait de phase
subplot(122)
plot(yint(1,:),yint(2,:),'k')
hold on
plot(vv,v_null_nostim,vv,w_null,vv,v_null_stim)
axis([-2.5 2.5 -1.5 1.5]); 
axis square
xlabel('V - potentiel de la membrane'); 
ylabel('W - variable de recuperation');
legend('trajectoire de (V,W)', ...
       'nullcline de V repos', ...
       'nullcline de W', ...
       'nullcline de V stimule','Location','South');


simulation_output = sol;

% Fonctions imbriquees
% ------------------------------------------------------------------

    function dxdt = fitz(t,x)
    % FITZ EDO pour le modele de Fitzhugh-Nagumo
        
        % variables dynamiques
        v = x(1); % potentiel de la membrane
        w = x(2); % variable de recuperation
        
        % equations differentielles
        dxdt = [ v - v.^3/3 - w + input_current(t);
            a*( v + b - c*w )];
        
    end

    function I = input_current(t)
    % INPUT_CURRENT courant applique a la membrane
        
        I = intensite * ( (t >= t0) & (t < (t0 + duree)) );
    
    end

% ------------------------------------------------------------------

end
          </pre>

          <h3>Exercice 1</h3>

          <p>Simulez le modèle FHN avec les paramètres par défaut donnés dans le fichier <a href="fitzhughnagumo.m">fitzhughnagumo.m</a>. Pour cela, appelez la fonction <tt>fitzhughnagumo</tt> depuis la <tt>Command Window</tt>:</p><pre class="matlab-code">fitzhughnagumo;
</pre>
          <p>a) Une figure avec deux panneaux s'affiche. Interprétez ce que vous voyez. Pour chaque panneau, que représente chaque courbe? Quel bout de code a servi à tracer les panneau? Ou se trouve l'équilibre du système en l'absence de stimulation? Ou se trouve l'équilibre du systeme en presence de stimulation? Voyez-vous une différence?</p>

          <p>b) Changez les paramètres de courant appliqué et lancez la simulation à nouveau. Par exemple, diminuez l'intensité ou la durée du courant appliqué. Qu'observez-vous quand la stimulation devient faible et/ou courte?</p>

          <h3>Exercice 2</h3>

          <p>Le modele FHN est un système excitable. En absence de stimulation, il possede un etat d'equilibre stable, mais si l'etat du systeme est suffisament perturbe, le systeme decrira un grande trajectoire dans l'espace de phase avant de revenir a son equilibre.</p>

          <p>Modifiez le fichier <tt>fitzhughnagumo.m</tt> pour explorer systématiquement l'excitabilité du modèle FHN. Fixez la durée de la stimulation a <code>duree = 10</code>, et faites varier l'<code>intensite</code> du courant appliqué. Pour cela, utilisez une boucle <code>for</code> pour calculer les solution du système pour différentes valeurs de l'<code>intensite</code>. Tracez ensuite les solutions pour chacune des valeurs de parametre. Vous devriez voir un seuil a partir duquel les trajectoire decrivent des excursions tres grandes.</p>

          <h3>Exercice 3</h3>

          <p>Pour certaines valeurs de l'<code>intensite</code>, si on applique un courant continu, l'équilibre du système devient instable et on obtient des oscillations soutenues. Par contre, si l'intensite est trop elevee, le systeme cesse d'osciller.</p>

          <p>Modifiez la fonction <code>input_current</code> de <tt>fitzhughnagumo.m</tt> de façon à avoir une intensité qui augmente linéairement avec le temps, et simulez le systeme. Le système devrait osciller sur un interval de temps fini.</p>

          <h3>Exercice 4 (Lecture)</h3>

          <p>Comparer ce que vous avez observé avec le papier de FitzHugh. Est-ce que vos observation sont coherentes avec les resultats du papier? <a href="http://scholarpedia.org/article/FitzHugh-Nagumo_model">FitzHugh avait fait ses simulations sur un ordinateur analogique</a>.</p>

        </div>

      </div>
    </div><!--container-fluid-->


    <hr>

      <footer>
        <!--<p>&copy; Company 2014</p>-->
      </footer>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>
  </body>
</html>
