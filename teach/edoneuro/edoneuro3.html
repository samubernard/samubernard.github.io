<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>EDOneuro Séance 3</title>

    <!--MATHJAX typing maths like in latex-->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script>
    <script type="text/javascript"
      src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
    <!-- MATHJAX-->

    <!-- jQuery -->
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script> 

    <!-- Bootstrap -->
    <link href="../../css/bootstrap.min.css" rel="stylesheet" media="all">

    <!-- Matlab highlighter -->
    <link href="../../css/matlab-highlighter-1.55.css" rel="stylesheet" type="text/css">
    <script src="../../js/matlab-highlighter-1.55.min.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>



   <!--<body style="padding-top: 50px;">-->
  <body onload="highlightMATLABCode();">

    <div class="container-fluid">
      <div class="row">


        <!--CONTENT HERE-->

        <ol class="breadcrumb">
            <li><a href="../../index.html">EDOneuro</a></li>
            <li class="active">TP de la séance 3</li>
        </ol>

        <div class="col-xs-12 col-sm-12 col-md-12">

          <div class="alert alert-info" role="alert">
            Fichiers à télécharger: 
            <ul>
              <li><a href="hopfield.m">hopfield.m</a></li>
              <li><a href="hebbianLearning.m">hebbianLearning.m</a></li>
              <li><a href="jpg2vect.m">jpg2vect.m</a></li>
              <li><a href="campagne_small.jpg">campagne_small.jpg</a></li>
              <li><a href="pontcanal_small.jpg">pontcanal_small.jpg</a></li>
              <li><a href="ville_small.jpg"></a>ville_small.jpg</li>
              <li><a href="hopfielddata.mat"></a>hopfielddata.mat</li>
            </ul>
          </div>

          <h2>Réseaux de Hopfield</h2>

          <p>Une réseau de Hopfield est un réseau récurrent de neurones artificiels. Chaque neurones est décrit par une seule variable $x$, régie par l'équation</p>

            $$\frac{dx(t)}{dt} = -\frac{x(t)}{\tau} + I(t),$$

          <p>La stimulation $I(t)$ provient des neurones voisins. Une matrice $W$ définit la force de couplage entre deux neurones. Pour $N$ neurones, la matrice $W$ sera de taille $N \times N$. On suppose que la stimulation des neurones est saturée. Le réseau est décrit par le système de $N$ équations différentielles</p>

            $$\frac{d\mathbf{x}(t)}{dt} = -\frac{\mathbf{x}(t)}{\tau} + W \arctan(a \mathbf{x}),$$

          <p>avec $\mathbf{x} \in \mathbb{R}^N$, et où le terme $W \arctan(a \mathbf{x})$ s'entend comme le produit de la matrice $W$ et du vecteur $\arctan(a \mathbf{x})$.</p> 

          <p><em>Note: une formulation en temps discret et états discrets est aussi possible.</em></p>

          <p>On stocke de l'information (mémoire) en stabilisant les états à mémoriser. Selon les conditions initiales, le système convergera vers l'un ou l'autre des états stables. L'apprentissage hebbien est une façon d'entraîner un réseau de neurones à mémoriser des états donnés.</p>


<pre class="matlab-code">function sol = hopfield(W,ics)
% HOPFIELD Recurrent artificial network
%  sol = hopfield(W,ic) solution du reseaux de Hopfield avec la matrice de
%  connexion W et les conditions initiales ICS. La matrice de connexion W
%  est carree de taille (NxM)^2. Les conditions initiales ICS doivent etre
%  de taille NxM.</pre>

<pre class="matlab-code">function W = hebbianLearning(p)
% HEBBIANLEARNING Regle d'apprentissage de Hebb
%  W = hebbianLearning(p) renvoie une matrice de connexion W basee sur la
%  regle d'apprentissage de Hebb pour un jeu de pattern d'apprentissage P
%  pour un reseau de Hopfield. P est un tableau NxM, ou N est le nombre de
%  neurones du reseau et M le nombre de patterns a memoriser. La matrice W
%  est de taille NxN.
%
%  La regle de Hebb est inspiree du concept "Neurons that fire together,
%  wire together". Les connexions W(i,j) sont renforcees si les patterns
%  aux position i et j sont semblables.</pre>

<pre class="matlab-code">function p = jpg2vect(filename)
% JPG2VECT transforme une image JPG RGB en vecteur normalise pour le reseau
% de Hopfield. FILENAME est le nom d'un fichier JPG et P est un vecteur
% colonne de taille (NxM), si l'image est de taille NxM.</pre>

        <h3>Images</h3>
        <div class="col-xs-3">
          <img src="pontcanal_small.jpg" class="img-responsive" alt="Responsive image">
        </div>
        <div class="col-xs-3">
          <img src="campagne_small.jpg" class="img-responsive" alt="Responsive image">
        </div>
        <div class="col-xs-3">
          <img src="ville_small.jpg" class="img-responsive" alt="Responsive image">
        </div>


      </div>

      <div class="col-xs-12 col-sm-12 col-md-12">
        <h3>Exercice 1</h3>
        <p>A l'aide des codes <tt>jpg2vect</tt>, <tt>hebbianLearning</tt> et <tt>hopfield</tt>, entraînez un réseau de Hopfield à mémoriser les trois images <em>pontcanal_small</em>, <em>campagne_small</em> et <em>ville_small</em>. 
        Utilisez <tt>jpg2vect</tt> pour générer trois vecteurs colonnes stockés dans une matrice <code>p = [p1, p2, p3];</code>. Générez la matrice <code>W = hebbianLearning(p);</code> et lancez une simulation <code>sol = hopfield(W,ics);</code>, où <code>ics</code> est une matrice <var>n x m</var> représentant une image (prenez par exemple une combinaison linéaire de deux images parmis les trois apprises par le réseau). Ici, <var>n x m = 40 x 40</var>. Le réseau de Hopfield devrait converger vers l'image la plus "proche".</p>

        <h3>Exercice 2</h3>
        <p>Ajoutez une image de votre choix aux images déjà apprises. L'image doit être du même format que les trois images de départ, c.-à-d. une image JPG de taille 40 x 40 pixels. La fonction <tt>jpg2vect</tt> convertit une image couleur en niveaux de gris en extrayant le canal R (rouge) de l'image.</p>

        <h3>Exercice 3</h3>
        <p>Implémentez une fonction <tt>energie</tt> qui calcule la fonction énergie le long des trajectoires du réseau.</p>
        <pre class="matlab-code">function E = energie(x,W,tau,a)
% ENERGIE fonction energie du reseau de Hopfield
%   E = energie(x,W,tau,a) prend en parametre une trajectoire X du reseau de Hopfield,
%   la matrice W de connectivite et les parametre du systeme TAU et A. X est une matrice
%   NxT et W une matrice NxN, avec N le nombre de neurones dans le reseau et T le nombre
%   de points temporels ou la trajectoire a ete calculee.</pre>

        <p>La fonction énergie est

          $$E = - \frac{1}{2} \mathbf{v}^* W \mathbf{v} + \sum_{j=1}^N \frac{1}{\tau} \int_0^{v_j} \frac{\tan(v)}{a} dv$$

        où $\mathbf{v} = \arctan(a \mathbf{x})$. Vous pouvez calculer l'intégrale numériquement à l'aide de la fonction <tt>integral</tt>, ou bien utiliser la primitive suivante</p>

          $$\int \tan(x)dx = - \ln[\cos(x)].$$

        <p>Calculez diverses trajectoires du réseau de Hopfield et affichez l'évolution énergie. 
          Confirmez que <var>E</var> est décroissante.</p>


      </div>

            </div><!--container-fluid-->


    <hr>

      <footer>
        <!--<p>&copy; Company 2014</p>-->
      </footer>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>
  </body>
</html>
